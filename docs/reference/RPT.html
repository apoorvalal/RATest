<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Robust Permutation Test — RPT • RATest</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>
<meta property="og:title" content="Robust Permutation Test — RPT" />

<meta property="og:description" content="This function considers the general problem of inference from the permutation distribution when comparing parameters from k populations. The test statistics will be based on the difference of estimators that are asymptotically linear. For illustrative purposes we will consider here the 2 sample case, but the function works for k-samples.
Difference of means: Here, the null hypothesis is of the form \(H_0: \mu(P)-\mu(Q)=0\), and the corresponding test statistic is given by 
 $$T_{m,n}=\frac{N^{1/2}(\bar{X}_m-\bar{Y}_n)}{\sqrt{\frac{N}{m}\sigma^2_m(X_1,\dots,X_m)+ \frac{N}{n}\sigma^2_n(Y_1,\dots,Y_n)}}$$  
 where \(\bar{X}_m\) and \(\bar{Y}_n\) are the sample means from population \(P\) and population \(Q\), respectively, and \(\sigma^2_m(X_1,\dots,X_m)\) is a consistent estimator of \(\sigma^2(P)$ when $X_1,\dots,X_m\) are i.i.d. from \(P\). Assume consitency also under \(Q\).
Difference of medians: Let \(F\) and \(G\) be the CDFs corresponding to \(P\) and \(Q\), and denote \(\theta(F)\) the median of \(F\) i.e. \(\theta(F)=\inf\{x:F(x)\ge1/2\}\). Assume that \(F\) is continuously differentiable at \(\theta(P)\) with derivative \(F'\) (and the same with \(F\) replaced by \(G\)). Here, the null hypothesis is of the form  \(H_0: \theta(P)-\theta(Q)=0\), and the corresponding test statistic is given by
$$T_{m,n}=\frac{N^{1/2}\left(\theta(\hat{P}_m)-\theta(\hat{Q})\right)}{\hat{\upsilon}_{m,n}}$$
where \(\hat{\upsilon}_{m,n}\) is a consistent estimator of \(\upsilon(P,Q)\):
$$\upsilon(P,Q)=\frac{1}{\lambda}\frac{1}{4(F'(\theta))^2}+\frac{1}{1-\lambda}\frac{1}{4(G'(\theta))^2}$$
Choices of \(\hat{\upsilon}_{m,n}\) may include the kernel estimator of Devroye and Wagner (1980), the bootstrap estimator of Efron (1992), or the smoothed bootstrap  Hall et al. (1989) to list a few. For further details, see Chung and Romano (2013). Current implementation uses the bootstrap estimator of Efron (1992)                                                                                       
Difference of variances: Here, the null hypothesis is of the form \(H_0: \sigma^2(P)-\sigma^2(Q)=0\), and the corresponding test statistic is given by 
$$T_{m,n}=\frac{N^{1/2}(\hat{\sigma}_m^2(X_1,\dots,X_,)-\hat{\sigma}_n^2(Y_1,\dots,Y_n))}{\sqrt{\frac{N}{m}(\hat{\mu}_{4,x}-\frac{(m-3)}{(m-1)}(\hat{\sigma}_m^2)^2)+\frac{N}{n}(\hat{\mu}_{4,y}-\frac{(n-3)}{(n-1)}(\hat{\sigma}_y^2)^2)}}$$ 
where \(\hat{\mu}_{4,m}\) the sample analog of \(E(X-\mu)^4\) based on an iid sample \(X_1,\dots,X_m\) from \(P\). Similarly for \(\hat{\mu}_{4,n}\)." />
<meta name="twitter:card" content="summary" />
<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">RATest</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Robust Permutation Test</h1>
    
    </div>

    
    <p>This function considers the general problem of inference from the permutation distribution when comparing parameters from k populations. The test statistics will be based on the difference of estimators that are asymptotically linear. For illustrative purposes we will consider here the 2 sample case, but the function works for k-samples.</p>
<p>Difference of means: Here, the null hypothesis is of the form \(H_0: \mu(P)-\mu(Q)=0\), and the corresponding test statistic is given by 
 $$T_{m,n}=\frac{N^{1/2}(\bar{X}_m-\bar{Y}_n)}{\sqrt{\frac{N}{m}\sigma^2_m(X_1,\dots,X_m)+ \frac{N}{n}\sigma^2_n(Y_1,\dots,Y_n)}}$$  
 where \(\bar{X}_m\) and \(\bar{Y}_n\) are the sample means from population \(P\) and population \(Q\), respectively, and \(\sigma^2_m(X_1,\dots,X_m)\) is a consistent estimator of \(\sigma^2(P)$ when $X_1,\dots,X_m\) are i.i.d. from \(P\). Assume consitency also under \(Q\).</p>
<p>Difference of medians: Let \(F\) and \(G\) be the CDFs corresponding to \(P\) and \(Q\), and denote \(\theta(F)\) the median of \(F\) i.e. \(\theta(F)=\inf\{x:F(x)\ge1/2\}\). Assume that \(F\) is continuously differentiable at \(\theta(P)\) with derivative \(F'\) (and the same with \(F\) replaced by \(G\)). Here, the null hypothesis is of the form  \(H_0: \theta(P)-\theta(Q)=0\), and the corresponding test statistic is given by
$$T_{m,n}=\frac{N^{1/2}\left(\theta(\hat{P}_m)-\theta(\hat{Q})\right)}{\hat{\upsilon}_{m,n}}$$
where \(\hat{\upsilon}_{m,n}\) is a consistent estimator of \(\upsilon(P,Q)\):
$$\upsilon(P,Q)=\frac{1}{\lambda}\frac{1}{4(F'(\theta))^2}+\frac{1}{1-\lambda}\frac{1}{4(G'(\theta))^2}$$
Choices of \(\hat{\upsilon}_{m,n}\) may include the kernel estimator of Devroye and Wagner (1980), the bootstrap estimator of Efron (1992), or the smoothed bootstrap  Hall et al. (1989) to list a few. For further details, see Chung and Romano (2013). Current implementation uses the bootstrap estimator of Efron (1992)</p>                                                                                       
<p>Difference of variances: Here, the null hypothesis is of the form \(H_0: \sigma^2(P)-\sigma^2(Q)=0\), and the corresponding test statistic is given by 
$$T_{m,n}=\frac{N^{1/2}(\hat{\sigma}_m^2(X_1,\dots,X_,)-\hat{\sigma}_n^2(Y_1,\dots,Y_n))}{\sqrt{\frac{N}{m}(\hat{\mu}_{4,x}-\frac{(m-3)}{(m-1)}(\hat{\sigma}_m^2)^2)+\frac{N}{n}(\hat{\mu}_{4,y}-\frac{(n-3)}{(n-1)}(\hat{\sigma}_y^2)^2)}}$$ 
where \(\hat{\mu}_{4,m}\) the sample analog of \(E(X-\mu)^4\) based on an iid sample \(X_1,\dots,X_m\) from \(P\). Similarly for \(\hat{\mu}_{4,n}\).</p>
    

    <pre class="usage"><span class='fu'>RPT</span>(<span class='no'>formula</span>, <span class='no'>data</span>, <span class='kw'>test</span> <span class='kw'>=</span> <span class='st'>"means"</span>, <span class='kw'>n.perm</span> <span class='kw'>=</span> <span class='fl'>499</span>, <span class='no'>na.action</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a formula object, in which the response variable is on the left of a ~ operator, and the groups on the right.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>a data.frame containing the named variables needed for the formula. If this argument is missing, then the variables in the formula should be on the search list.</p></td>
    </tr>
    <tr>
      <th>test</th>
      <td><p>testing problem. It admits  "means" if the objective is to test for difference of Means, "medians" for difference of Medians, and "variances" for difference of Variances. In the case the user is interested in testing for difference of medians, the Efron (1992) bootstrap estimator is used to estimate the variances (For further details, see Chung and Romano (2013))</p></td>
    </tr>
    <tr>
      <th>n.perm</th>
      <td><p>Numeric. Number of permutations needed for the stochastic approximation of the p-values. The default is n.perm=499.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function to filter missing data. This is applied to the model.frame . The default is na.omit, which deletes observations that contain one or more missing values.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class "RPT" is a list containing at least the following components:</p>
<dt>description</dt><dd><p>Type of test, can be Difference of Means, Medians, or Variances.</p></dd>
 <dt>n_populations</dt><dd><p>Number of grups.</p></dd>
 <dt>N</dt><dd><p>Sample Size.</p></dd>
 <dt>T.obs</dt><dd><p>Observed test statistic.</p></dd>
 <dt>pvalue</dt><dd><p>P-value.</p></dd>
 <dt>T.perm</dt><dd><p>Vector. Test statistics calculated from the permutations of the data.</p></dd>
 <dt>n_perm</dt><dd><p>Number of permutations.</p></dd>
 <dt>parameters</dt><dd><p>Estimated parameters.</p></dd>
 <dt>sample_sizes</dt><dd><p>Sample size of groups.</p></dd>

    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chung, E. and Romano, J. P. (2013). Exact and asymptotically robust permutation tests. The Annals of Statistics, 41(2):484–507.</p>
<p>Chung, E. and Romano, J. P. (2016). Asymptotically valid and exact permutation tests based on two-sample u-statistics. Journal of Statistical Planning and Inference, 168:97–105.</p>
<p>Devroye, L. P. and Wagner, T. J. (1980). The strong uniform consistency of kernel density estimates. In Multivariate Analysis V: Proceedings of the fifth International Symposium on Multivariate Analysis, volume 5, pages 59–77.</p>
<p>Efron, B. (1992). Bootstrap methods: another look at the jackknife. In Breakthroughs in statistics, pages 569–593. Springer.
Hall, P., DiCiccio, T. J., and Romano, J. P. (1989). On smoothing and the bootstrap. The Annals of Statistics, pages 692–704.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='no'>male</span><span class='kw'>&lt;-</span><span class='fu'>rnorm</span>(<span class='fl'>50</span>,<span class='fl'>1</span>,<span class='fl'>1</span>)
<span class='no'>female</span><span class='kw'>&lt;-</span><span class='fu'>rnorm</span>(<span class='fl'>50</span>,<span class='fl'>1</span>,<span class='fl'>2</span>)
<span class='no'>dta</span><span class='kw'>&lt;-</span><span class='fu'>data.frame</span>(<span class='kw'>group</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='fu'>rep</span>(<span class='fl'>1</span>,<span class='fl'>50</span>),<span class='fu'>rep</span>(<span class='fl'>2</span>,<span class='fl'>50</span>)),<span class='kw'>outcome</span><span class='kw'>=</span><span class='fu'>c</span>(<span class='no'>male</span>,<span class='no'>female</span>))
<span class='no'>rpt.var</span><span class='kw'>&lt;-</span><span class='fu'>RPT</span>(<span class='no'>dta</span>$<span class='no'>outcome</span>~<span class='no'>dta</span>$<span class='no'>group</span>,<span class='kw'>test</span><span class='kw'>=</span><span class='st'>"variances"</span>)
<span class='fu'>summary</span>(<span class='no'>rpt.var</span>)

<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Maurcio Olivares Gonzalez

Ignacio Sarmiento Barbieri

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mauricio Olivares-Gonzalez, Ignacio Sarmiento-Barbieri.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>

